# =========================
# Server Config
# =========================
HOST=localhost
PORT=3000

# ✅ API Version Control
API_VERSION=v1

# =========================
# Database
# =========================
DATABASE_URL="postgresql://bpa_admin:password123@localhost:5432/bpa_pet_db?schema=public"

# =========================
# JWT
# =========================
JWT_SECRET="CHANGE_ME_TO_A_LONG_RANDOM_SECRET_64CHARS_MIN"
JWT_EXPIRES_IN="30d"

# =========================
# MinIO / S3 Config
# =========================
AWS_REGION="us-east-1"
AWS_BUCKET_NAME="bpa-pets"
AWS_ENDPOINT="http://127.0.0.1:9000"

AWS_ACCESS_KEY_ID="admin"
AWS_SECRET_ACCESS_KEY="password123"

MINIO_PUBLIC_URL="http://192.168.10.111:9000"

# =========================
# ✅ Security: CORS Allowlist (v18)
# Comma separated origins
# Example: https://yourapp.com,https://admin.yourapp.com
# =========================
CORS_ORIGINS="http://localhost:3000,http://localhost:3103,http://localhost:5173,http://127.0.0.1:3000"

# =========================
# ✅ Security: Rate Limit (v18)
# You can tune these anytime
# =========================
RL_WINDOW_MS=900000
RL_GENERAL_MAX=300
RL_AUTH_MAX=20
RL_WITHDRAW_WINDOW_MS=60000
RL_WITHDRAW_MAX=10
RL_WEBHOOK_WINDOW_MS=60000
RL_WEBHOOK_MAX=120

# =========================
# ✅ Security: Admin 2FA (TOTP) (v18)
# If true => admin sensitive payout actions require OTP
# ADMIN_2FA_TOTP_SECRET must be Base32 (Google Authenticator compatible)
# =========================
ADMIN_2FA_REQUIRED=false
ADMIN_2FA_TOTP_SECRET="CHANGE_ME_BASE32_TOTP_SECRET"

# =========================
# ✅ Security: Encrypt payoutDetailsJson at rest (v18)
# WALLET_PAYOUT_DETAILS_KEY must be 32-byte key (base64 recommended)
# Example generate (Node): crypto.randomBytes(32).toString('base64')
# =========================
WALLET_PAYOUT_DETAILS_KEY="CHANGE_ME_32BYTE_BASE64_KEY"

# =========================
# ✅ Security: Webhook strict mode (v18)
# If true => reject webhook when signature is invalid/missing
# =========================
WEBHOOK_SIGNATURE_REQUIRED=false

# =========================
# ✅ Optional: Idempotency settings (v18)
# How long to remember Idempotency-Key results (seconds)
# =========================
IDEMPOTENCY_TTL_SECONDS=86400

# =========================
# ✅ Optional: Audit Log location (v18)
# =========================
ADMIN_AUDIT_LOG_PATH="logs/admin-audit.log"

